<div class="admin-dashboard">
  <!-- Error Alert -->
  <div *ngIf="hasError" class="alert alert-warning alert-dismissible fade show" role="alert">
    <i class="typcn typcn-warning me-2"></i>
    {{ errorMessage }}
    <button type="button" class="btn btn-sm btn-outline-primary ms-2" (click)="retryLoad()">
      <i class="typcn typcn-refresh me-1"></i>
      Retry
    </button>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="d-flex justify-content-center align-items-center" style="height: 400px;">
      <div class="text-center">
        <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
          <span class="visually-hidden">Loading dashboard...</span>
        </div>
        <h5 class="text-muted">Loading Dashboard Data...</h5>
        <p class="text-muted">Please wait while we fetch the latest information</p>
      </div>
    </div>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading">
    <!-- Statistics Cards Row -->
    <div class="row">
      <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
        <div class="card stats-card card-primary">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
              <div class="stats-info">
                <h6 class="card-title">Total Sales</h6>
                <h3 class="stats-value mb-0">{{ formatNumber(displayStats.totalSales) }}</h3>
                <div class="growth-indicator mt-2">
                  <span class="growth-text text-success">
                    <i class="typcn typcn-arrow-up"></i>
                    {{ displayStats.salesGrowth }}%
                  </span>
                  <span class="growth-label text-muted ms-1">increase</span>
                </div>
              </div>
              <div class="stats-icon">
                <i class="typcn typcn-chart-line text-primary"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
        <div class="card stats-card card-success">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
              <div class="stats-info">
                <h6 class="card-title">Total Orders</h6>
                <h3 class="stats-value mb-0">{{ formatNumber(displayStats.totalOrders) }}</h3>
                <div class="growth-indicator mt-2">
                  <span class="growth-text text-success">
                    <i class="typcn typcn-arrow-up"></i>
                    {{ displayStats.ordersGrowth }}%
                  </span>
                  <span class="growth-label text-muted ms-1">increase</span>
                </div>
              </div>
              <div class="stats-icon">
                <i class="typcn typcn-shopping-bag text-success"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
        <div class="card stats-card card-info">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
              <div class="stats-info">
                <h6 class="card-title">Total Customers</h6>
                <h3 class="stats-value mb-0">{{ formatNumber(displayStats.totalCustomers) }}</h3>
                <div class="growth-indicator mt-2">
                  <span class="growth-text text-success">
                    <i class="typcn typcn-arrow-up"></i>
                    {{ displayStats.customersGrowth }}%
                  </span>
                  <span class="growth-label text-muted ms-1">increase</span>
                </div>
              </div>
              <div class="stats-icon">
                <i class="typcn typcn-group text-info"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
        <div class="card stats-card card-warning">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
              <div class="stats-info">
                <h6 class="card-title">Total Revenue</h6>
                <h3 class="stats-value mb-0">{{ formatCurrency(displayStats.totalRevenue) }}</h3>
                <div class="growth-indicator mt-2">
                  <span class="growth-text text-success">
                    <i class="typcn typcn-arrow-up"></i>
                    {{ displayStats.revenueGrowth }}%
                  </span>
                  <span class="growth-label text-muted ms-1">increase</span>
                </div>
              </div>
              <div class="stats-icon">
                <i class="typcn typcn-calculator text-warning"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Row -->
    <div class="row">
      <div class="col-lg-8 grid-margin stretch-card">
        <div class="card chart-widget">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <div class="chart-title">
                <h5 class="card-title mb-0">Sales Overview</h5>
                <p class="card-subtitle text-muted mb-0">Monthly sales performance</p>
              </div>
              <div class="chart-actions">
                <button class="btn btn-link text-muted p-0" type="button">
                  <i class="typcn typcn-cog"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 400px;">
              <canvas id="salesChart"></canvas>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4 grid-margin stretch-card">
        <div class="card chart-widget">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <div class="chart-title">
                <h5 class="card-title mb-0">Orders by Day</h5>
                <p class="card-subtitle text-muted mb-0">Weekly order distribution</p>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 400px;">
              <canvas id="ordersChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Data Tables Row -->
    <div class="row">
      <div class="col-lg-7 grid-margin stretch-card">
        <div class="card data-card">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <div class="card-title-section">
                <h5 class="card-title mb-0">Recent Orders</h5>
                <p class="card-subtitle text-muted mb-0">Latest customer orders</p>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Order ID</th>
                    <th>Customer</th>
                    <th>Product</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Date</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let order of recentOrders">
                    <td class="font-weight-medium">{{ order.id }}</td>
                    <td>{{ order.customer }}</td>
                    <td>{{ order.product }}</td>
                    <td>{{ formatCurrency(order.amount) }}</td>
                    <td>
                      <span class="badge" [ngClass]="getStatusClass(order.status)">
                        {{ order.status | titlecase }}
                      </span>
                    </td>
                    <td>{{ order.date | date:'short' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="card-footer text-center">
            <a href="javascript:void(0);" class="btn btn-outline-primary btn-sm">
              View All Orders
            </a>
          </div>
        </div>
      </div>
      
      <div class="col-lg-5 grid-margin stretch-card">
        <div class="card data-card">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <div class="card-title-section">
                <h5 class="card-title mb-0">Top Products</h5>
                <p class="card-subtitle text-muted mb-0">Best selling products</p>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="top-products-list">
              <div class="product-item d-flex align-items-center" *ngFor="let product of topProducts">
                <div class="product-image me-3">
                  <img [src]="product.image" [alt]="product.name" class="rounded" 
                       style="width: 50px; height: 50px; object-fit: cover;"
                       (error)="$event.target.src='assets/images/placeholder-product.jpg'">
                </div>
                <div class="product-info flex-grow-1">
                  <h6 class="product-name mb-1">{{ product.name }}</h6>
                  <p class="product-category text-muted mb-1">{{ product.category }}</p>
                  <div class="product-stats d-flex justify-content-between">
                    <span class="sales-count">{{ product.sales }} sales</span>
                    <span class="revenue-amount font-weight-bold">{{ formatCurrency(product.revenue) }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card-footer text-center">
            <a href="javascript:void(0);" class="btn btn-outline-primary btn-sm">
              View All Products
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Additional Analytics Row -->
    <div class="row">
      <div class="col-lg-12 grid-margin stretch-card">
        <div class="card chart-widget">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <div class="chart-title">
                <h5 class="card-title mb-0">Revenue Trends</h5>
                <p class="card-subtitle text-muted mb-0">Quarterly revenue analysis</p>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="revenueChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
