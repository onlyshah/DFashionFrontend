<!-- Pollux UI Admin Layout -->
<div class="container-scroller">
  <!-- Top Navbar -->
  <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
    <div class="navbar-brand-wrapper d-flex justify-content-center">
      <div class="navbar-brand-inner-wrapper d-flex justify-content-between align-items-center w-100">
        <a class="navbar-brand brand-logo" routerLink="/dashboard">
          <i class="typcn typcn-shopping-bag"></i>
          DFashion
        </a>
        <a class="navbar-brand brand-logo-mini" routerLink="/dashboard">
          <i class="typcn typcn-shopping-bag"></i>
        </a>
        <button class="navbar-toggler navbar-toggler align-self-center" type="button" (click)="toggleSidebar()">
          <i class="typcn typcn-th-menu"></i>
        </button>
      </div>
    </div>
    <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
      <ul class="navbar-nav me-lg-2">
        <li class="nav-item nav-profile dropdown" *ngIf="currentUser">
          <a class="nav-link" href="#" [matMenuTriggerFor]="profileMenu" id="profileDropdown">
            <div class="user-avatar" [style.background-color]="getRoleColor()">
              <span class="user-initials">{{ getUserInitials() }}</span>
            </div>
            <span class="nav-profile-name">{{ currentUser.fullName }}</span>
          </a>
          <mat-menu #profileMenu="matMenu" class="dropdown-menu">
            <button mat-menu-item>
              <i class="typcn typcn-cog-outline text-primary"></i>
              Settings
            </button>
            <button mat-menu-item (click)="onLogout()">
              <i class="typcn typcn-eject text-primary"></i>
              Logout
            </button>
          </mat-menu>
        </li>
        <li class="nav-item nav-user-status">
          <p class="mb-0">Last login: {{ getLastLoginTime() }}</p>
        </li>
      </ul>
      <ul class="navbar-nav navbar-nav-right">
        <li class="nav-item nav-date">
          <a class="nav-link d-flex justify-content-center align-items-center">
            <h6 class="date mb-0">Today: {{ getCurrentDate() }}</h6>
            <i class="typcn typcn-calendar"></i>
          </a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link count-indicator dropdown-toggle d-flex justify-content-center align-items-center" 
             [matMenuTriggerFor]="messageMenu">
            <i class="typcn typcn-mail mx-0"></i>
            <span class="count" *ngIf="unreadMessages > 0">{{ unreadMessages }}</span>
          </a>
          <mat-menu #messageMenu="matMenu" class="dropdown-menu">
            <div class="dropdown-header">Messages</div>
            <button mat-menu-item *ngFor="let message of recentMessages" class="preview-item">
              <div class="preview-thumbnail">
                <div class="user-avatar small">{{ message.senderInitials }}</div>
              </div>
              <div class="preview-item-content">
                <h6 class="preview-subject">{{ message.sender }}</h6>
                <p class="preview-text">{{ message.preview }}</p>
              </div>
            </button>
          </mat-menu>
        </li>
        <li class="nav-item dropdown me-0">
          <a class="nav-link count-indicator dropdown-toggle d-flex align-items-center justify-content-center" 
             [matMenuTriggerFor]="notificationMenu">
            <i class="typcn typcn-bell mx-0"></i>
            <span class="count" *ngIf="unreadNotifications > 0">{{ unreadNotifications }}</span>
          </a>
          <mat-menu #notificationMenu="matMenu" class="dropdown-menu">
            <div class="dropdown-header">Notifications</div>
            <button mat-menu-item *ngFor="let notification of recentNotifications" class="preview-item">
              <div class="preview-thumbnail">
                <div class="preview-icon" [ngClass]="'bg-' + notification.type">
                  <i class="typcn" [ngClass]="notification.icon"></i>
                </div>
              </div>
              <div class="preview-item-content">
                <h6 class="preview-subject">{{ notification.title }}</h6>
                <p class="preview-text">{{ notification.time }}</p>
              </div>
            </button>
          </mat-menu>
        </li>
      </ul>
      <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" 
              type="button" (click)="toggleSidebar()">
        <i class="typcn typcn-th-menu"></i>
      </button>
    </div>
  </nav>

  <!-- Breadcrumb Navbar -->
  <nav class="navbar-breadcrumb col-xl-12 col-12 d-flex flex-row p-0">
    <div class="navbar-links-wrapper d-flex align-items-stretch">
      <div class="nav-link">
        <a><i class="typcn typcn-calendar-outline"></i></a>
      </div>
      <div class="nav-link">
        <a><i class="typcn typcn-mail"></i></a>
      </div>
      <div class="nav-link">
        <a><i class="typcn typcn-folder"></i></a>
      </div>
      <div class="nav-link">
        <a><i class="typcn typcn-document-text"></i></a>
      </div>
    </div>
    <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
      <ul class="navbar-nav me-lg-2">
        <li class="nav-item ms-0">
          <h4 class="mb-0">{{ pageTitle }}</h4>
        </li>
        <li class="nav-item">
          <div class="d-flex align-items-baseline">
            <p class="mb-0">Home</p>
            <i class="typcn typcn-chevron-right"></i>
            <p class="mb-0">{{ breadcrumbTitle }}</p>
          </div>
        </li>
      </ul>
      <ul class="navbar-nav navbar-nav-right">
        <li class="nav-item nav-search d-none d-md-block me-0">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Search..." 
                   [(ngModel)]="searchQuery" (keyup.enter)="onSearch()">
            <div class="input-group-prepend d-flex">
              <span class="input-group-text" (click)="onSearch()">
                <i class="typcn typcn-zoom"></i>
              </span>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Page Body Wrapper -->
  <div class="container-fluid page-body-wrapper">
    <!-- Sidebar -->
    <nav class="sidebar sidebar-offcanvas" id="sidebar" [class.show]="sidebarOpen">
      <ul class="nav">
        <li class="nav-item" *ngFor="let item of navigationItems">
          <a class="nav-link" 
             [routerLink]="item.route" 
             routerLinkActive="active"
             *ngIf="!item.children"
             (click)="onMenuItemClick(item)">
            <i class="typcn" [ngClass]="item.icon + ' menu-icon'"></i>
            <span class="menu-title">{{ item.title }}</span>
            <div class="badge badge-danger" *ngIf="item.badge">{{ item.badge }}</div>
          </a>
          
          <!-- Dropdown Menu -->
          <a class="nav-link" 
             [attr.data-bs-toggle]="item.children ? 'collapse' : null"
             [attr.href]="item.children ? '#' + item.id : null"
             [attr.aria-expanded]="item.expanded"
             [attr.aria-controls]="item.id"
             *ngIf="item.children"
             (click)="toggleSubmenu(item)">
            <i class="typcn" [ngClass]="item.icon + ' menu-icon'"></i>
            <span class="menu-title">{{ item.title }}</span>
            <i class="menu-arrow typcn typcn-chevron-right"></i>
          </a>
          <div class="collapse" [id]="item.id" [class.show]="item.expanded" *ngIf="item.children">
            <ul class="nav flex-column sub-menu">
              <li class="nav-item" *ngFor="let child of item.children">
                <a class="nav-link" [routerLink]="child.route" routerLinkActive="active">
                  {{ child.title }}
                </a>
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </nav>

    <!-- Main Panel -->
    <div class="main-panel">
      <div class="content-wrapper">
        <!-- Router Outlet for Page Content -->
        <router-outlet></router-outlet>
      </div>
      
      <!-- Footer -->
      <footer class="footer">
        <div class="card">
          <div class="card-body">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">
                Copyright Â© {{ currentYear }} 
                <a href="#" class="text-muted" target="_blank">DFashion</a>. 
                All rights reserved.
              </span>
              <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">
                Hand-crafted & made with 
                <i class="typcn typcn-heart-full-outline text-danger"></i>
              </span>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>
</div>

<!-- Mobile Overlay -->
<div class="mobile-overlay" 
     [class.show]="sidebarOpen" 
     (click)="closeSidebar()"
     *ngIf="isMobile"></div>
