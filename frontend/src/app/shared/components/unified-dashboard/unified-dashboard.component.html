<div class="unified-dashboard" [ngClass]="getDashboardClasses()">
  
  <!-- Admin Layout -->
  <div *ngIf="dashboardConfig.layout === 'admin'" class="admin-layout">
    <mat-sidenav-container class="sidenav-container">
      
      <!-- Admin Sidebar -->
      <mat-sidenav #drawer 
                   class="sidenav admin-sidenav" 
                   fixedInViewport
                   [attr.role]="isMobile ? 'dialog' : 'navigation'"
                   [mode]="isMobile ? 'over' : 'side'"
                   [opened]="sidebarOpen">
        
        <!-- Sidebar Header -->
        <div class="sidenav-header">
          <div class="logo">
            <mat-icon class="logo-icon">hub</mat-icon>
            <span class="logo-text">StyleHub</span>
          </div>
          <div class="admin-badge">
            {{ isSuperAdmin ? 'Super Admin' : 'Admin Panel' }}
          </div>
        </div>

        <!-- Admin Navigation -->
        <nav class="admin-nav">
          <div class="nav-section">
            <h6 class="nav-section-title">Dashboard</h6>
            <a routerLink="/admin/dashboard" 
               routerLinkActive="active" 
               class="nav-item">
              <mat-icon>dashboard</mat-icon>
              <span>Overview</span>
            </a>
          </div>

          <div class="nav-section" *hasFeature="'user-management'">
            <h6 class="nav-section-title">User Management</h6>
            <a routerLink="/admin/users"
               routerLinkActive="active"
               class="nav-item">
              <mat-icon>people</mat-icon>
              <span>Users</span>
            </a>
            <a routerLink="/admin/users/roles"
               routerLinkActive="active"
               class="nav-item"
               *hasFeature="'role-management'">
              <mat-icon>admin_panel_settings</mat-icon>
              <span>Roles & Permissions</span>
            </a>
          </div>

          <div class="nav-section" *hasFeature="'product-management'">
            <h6 class="nav-section-title">Commerce</h6>
            <a routerLink="/admin/products"
               routerLinkActive="active"
               class="nav-item">
              <mat-icon>inventory</mat-icon>
              <span>Products</span>
            </a>
            <a routerLink="/admin/orders"
               routerLinkActive="active"
               class="nav-item"
               *hasFeature="'order-management'">
              <mat-icon>shopping_cart</mat-icon>
              <span>Orders</span>
            </a>
          </div>

          <div class="nav-section" *hasFeature="'system-monitoring'">
            <h6 class="nav-section-title">System</h6>
            <a routerLink="/admin/system/monitoring"
               routerLinkActive="active"
               class="nav-item">
              <mat-icon>monitor_heart</mat-icon>
              <span>Monitoring</span>
            </a>
            <a routerLink="/admin/system/logs"
               routerLinkActive="active"
               class="nav-item"
               *hasFeature="'system-logs'">
              <mat-icon>description</mat-icon>
              <span>System Logs</span>
            </a>
            <a routerLink="/admin/settings"
               routerLinkActive="active"
               class="nav-item"
               *hasFeature="'application-settings'">
              <mat-icon>settings</mat-icon>
              <span>Settings</span>
            </a>
          </div>
        </nav>
      </mat-sidenav>

      <!-- Admin Main Content -->
      <mat-sidenav-content class="main-content">
        <!-- Admin Top Bar -->
        <mat-toolbar class="admin-toolbar" *ngIf="dashboardConfig.showTopBar">
          <button type="button"
                  mat-icon-button
                  (click)="toggleSidebar()"
                  class="sidebar-toggle">
            <mat-icon>menu</mat-icon>
          </button>

          <span class="toolbar-spacer"></span>

          <!-- Notifications -->
          <button mat-icon-button 
                  (click)="navigateToNotifications()"
                  [matBadge]="notificationCount"
                  [matBadgeHidden]="notificationCount === 0"
                  matBadgeColor="warn">
            <mat-icon>notifications</mat-icon>
          </button>

          <!-- User Menu -->
          <button mat-icon-button 
                  [matMenuTriggerFor]="userMenu"
                  class="user-menu-trigger">
            <img [src]="currentUser?.avatar || '/assets/images/default-avatar.png'" 
                 [alt]="currentUser?.fullName"
                 class="user-avatar">
          </button>

          <mat-menu #userMenu="matMenu">
            <div class="user-menu-header">
              <div class="user-info">
                <div class="user-name">{{ currentUser?.fullName }}</div>
                <div class="user-role">{{ currentUser?.role | titlecase }}</div>
              </div>
            </div>
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="navigateToProfile()">
              <mat-icon>person</mat-icon>
              <span>Profile</span>
            </button>
            <button mat-menu-item (click)="navigateToSettings()">
              <mat-icon>settings</mat-icon>
              <span>Settings</span>
            </button>
            <button mat-menu-item (click)="toggleTheme()">
              <mat-icon>palette</mat-icon>
              <span>Toggle Theme</span>
            </button>
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="logout()">
              <mat-icon>logout</mat-icon>
              <span>Logout</span>
            </button>
          </mat-menu>
        </mat-toolbar>

        <!-- Admin Dashboard Content -->
        <div class="dashboard-content admin-content">
          <app-admin-dashboard-features 
            [currentUser]="currentUser"
            [availableFeatures]="availableFeatures">
          </app-admin-dashboard-features>
        </div>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>

  <!-- Social Layout (Desktop) -->
  <div *ngIf="dashboardConfig.layout === 'social'" class="social-layout">
    <!-- Social Top Bar -->
    <header class="social-header" *ngIf="dashboardConfig.showTopBar">
      <div class="header-container">
        <div class="header-left">
          <h1 class="app-logo">StyleHub</h1>
        </div>
        
        <div class="header-center">
          <div class="search-container">
            <mat-icon>search</mat-icon>
            <input type="text" 
                   placeholder="Search..." 
                   class="search-input">
          </div>
        </div>
        
        <div class="header-right">
          <button mat-icon-button routerLink="/home">
            <mat-icon>home</mat-icon>
          </button>
          
          <button mat-icon-button 
                  (click)="navigateToNotifications()"
                  [matBadge]="notificationCount"
                  [matBadgeHidden]="notificationCount === 0"
                  matBadgeColor="warn">
            <mat-icon>favorite_border</mat-icon>
          </button>
          
          <button mat-icon-button>
            <mat-icon>add_box</mat-icon>
          </button>
          
          <button mat-icon-button 
                  [matMenuTriggerFor]="socialUserMenu">
            <img [src]="currentUser?.avatar || '/assets/images/default-avatar.png'" 
                 [alt]="currentUser?.fullName"
                 class="user-avatar">
          </button>

          <mat-menu #socialUserMenu="matMenu">
            <button mat-menu-item (click)="navigateToProfile()">
              <mat-icon>person</mat-icon>
              <span>Profile</span>
            </button>
            <button mat-menu-item routerLink="/wishlist" *ngIf="hasFeature('wishlist')">
              <mat-icon>favorite</mat-icon>
              <span>Wishlist</span>
            </button>
            <button mat-menu-item routerLink="/cart" *ngIf="hasFeature('cart')">
              <mat-icon>shopping_cart</mat-icon>
              <span>Cart</span>
            </button>
            <button mat-menu-item (click)="navigateToSettings()">
              <mat-icon>settings</mat-icon>
              <span>Settings</span>
            </button>
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="logout()">
              <mat-icon>logout</mat-icon>
              <span>Logout</span>
            </button>
          </mat-menu>
        </div>
      </div>
    </header>

    <!-- Social Dashboard Content -->
    <main class="social-content">
      <app-user-social-dashboard 
        [currentUser]="currentUser"
        [availableFeatures]="availableFeatures">
      </app-user-social-dashboard>
    </main>
  </div>

  <!-- Mobile Layout -->
  <div *ngIf="dashboardConfig.layout === 'mobile'" class="mobile-layout">
    <!-- Mobile Header -->
    <header class="mobile-header">
      <div class="header-container">
        <div class="header-left">
          <h1 class="app-logo">StyleHub</h1>
          <ion-icon name="chevron-down" class="logo-dropdown"></ion-icon>
        </div>
        <div class="header-right">
          <ion-icon name="heart-outline" 
                    class="header-icon"
                    [attr.data-count]="notificationCount > 0 ? notificationCount : null"
                    (click)="navigateToNotifications()"></ion-icon>
          <ion-icon name="chatbubble-outline" class="header-icon"></ion-icon>
        </div>
      </div>
    </header>

    <!-- Mobile Dashboard Content -->
    <main class="mobile-content">
      <app-user-social-dashboard 
        [currentUser]="currentUser"
        [availableFeatures]="availableFeatures"
        [isMobile]="true">
      </app-user-social-dashboard>
    </main>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav">
      <button class="nav-item" routerLink="/home" routerLinkActive="active">
        <ion-icon name="home"></ion-icon>
        <span>Home</span>
      </button>
      <button class="nav-item" routerLink="/search" routerLinkActive="active">
        <ion-icon name="search"></ion-icon>
        <span>Search</span>
      </button>
      <button class="nav-item" routerLink="/create" routerLinkActive="active">
        <ion-icon name="add"></ion-icon>
        <span>Create</span>
      </button>
      <button class="nav-item" routerLink="/shop" routerLinkActive="active" *ngIf="hasFeature('shopping')">
        <ion-icon name="storefront"></ion-icon>
        <span>Shop</span>
      </button>
      <button class="nav-item" (click)="navigateToProfile()">
        <img [src]="currentUser?.avatar || '/assets/images/default-avatar.png'" 
             [alt]="currentUser?.fullName"
             class="profile-avatar">
        <span>Profile</span>
      </button>
    </nav>
  </div>

  <!-- Shared Features (Available to all layouts) -->
  <app-shared-dashboard-features 
    [currentUser]="currentUser"
    [availableFeatures]="availableFeatures">
  </app-shared-dashboard-features>
</div>
